apiVersion: v1
kind: ConfigMap
metadata:
  name: audit-srv-config
  namespace: optimus-uat
  labels:
    app: audit-srv
data:
  application.yml: |+

    logging:
      pattern:
        console: "%d{yyyy-MM-dd HH:mm:ss.SSS} %5p ${PID:- } --- [%t] %-40.40logger{39} : %X{RID} %X{CID} - %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}"
      file.path: /var/log/optimus
    ##

    server:
      port: 8287
      servlet:
        context-path: /audit-server

    ##

    spring:
      main.allow-circular-references: true
      mvc:
        pathmatch:
          matching-strategy: ant_path_matcher
      data:
        mongodb:
          uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/common?ssl=false&authSource=admin  
      autoconfigure:
        exclude:
          - org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration
          - org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration

    jwt:
      secretKey: ${jwt.secretKey}
      notAfterInMins: 30
      expiryInMins: 15

    optimus:
      rest:
        swagger: true

    pattern:
      name: '[a-zA-Z0-9-_]+'

      
    collections: WidgetEntity, SourceEntity, SchedulerConfig, GLMaster
    skipFields: /createdAt/$date, /updatedAt, /updatedAt/$date, _id, updatedBy, _class, version, /condition/excel/id, /deletedFields, /workflowDiagram/offset, /x, /y, /inputSchema/fields, /uIConfig/publishedService, /publishedService
    auditlogcollectionname: auditlog
    auditLogresumetokencollectionname: auditlogresumetoken

    multi-tenant:
      enabled: true
      repositoryBasePackage: com.opus.optimus
      common:
        dbConnection:
          uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/common?ssl=false&authSource=admin
      tenants:
        dbConnections:
          optimus:
            uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/optimus?ssl=false&authSource=admin
          firstData:
            uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/firstData?ssl=false&authSource=admin
          tmobile:
            uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/tmobile?ssl=false&authSource=admin
          optimusfin:
            uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/optimusfin?ssl=false&authSource=admin
          testautomation:
            uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/testautomation?ssl=false&authSource=admin
          transactive:
            uri: mongodb://${mongodb.cosmos.username}:${mongodb.cosmos.password}@${mongodb.cosmos.host}:${mongodb.cosmos.port}/transactive?ssl=false&authSource=admin

    resumeAfterFlag: false
    cronExp: 0 0 * * * *

